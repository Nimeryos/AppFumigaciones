<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fumigaciones - Grilla</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  input { width: 80px; margin-right: 10px; }
  button { padding: 8px 14px; margin-top: 10px; }
  .grid { display: grid; gap: 4px; margin-top: 20px; }
  .cell {
    width: 40px; height: 40px;
    display: flex; justify-content: center; align-items: center;
    border: 1px solid #000; cursor: pointer;
    font-size: 18px;
    background: #f8f8f8;
  }
</style>
</head>
<body>
<h2>Generar grilla</h2>
<label>Pisos (X):</label>
<input type="number" id="x">
<label>Deptos por piso (Y):</label>
<input type="number" id="y">
<button onclick="generateGrid()">Crear</button>

<div id="grid" class="grid"></div>

<script>
const STATES = ["", "X", "-", "NO", "XG"];

function generateGrid() {
  const x = parseInt(document.getElementById("x").value);
  const y = parseInt(document.getElementById("y").value);

  if (!x || !y) return alert("Ingresá valores válidos.");

  const grid = document.getElementById("grid");
  grid.innerHTML = "";
  grid.style.gridTemplateColumns = `repeat(${y}, 40px)`;

  const saved = JSON.parse(localStorage.getItem("fumigrid") || "{}");

  for (let i = 0; i < x; i++) {
    for (let j = 0; j < y; j++) {
      const key = `${i}-${j}`;
      const div = document.createElement("div");
      div.className = "cell";
      div.textContent = saved[key] || "";

      div.onclick = () => {
        let current = STATES.indexOf(div.textContent);
        current = (current + 1) % STATES.length;
        div.textContent = STATES[current];
        saveGrid();
      };

      grid.appendChild(div);
    }
  }
}

function saveGrid() {
  const cells = document.querySelectorAll(".cell");
  const data = {};
  let i = 0;

  cells.forEach((c, index) => {
    const yVal = parseInt(document.getElementById("y").value);
    const x = Math.floor(index / yVal);
    const y = index % yVal;
    data[`${x}-${y}`] = c.textContent;
  });

  localStorage.setItem("fumigrid", JSON.stringify(data));
}
</script>
</body>
</html>
